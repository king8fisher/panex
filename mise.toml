[tools]
node = "22"
rust = "latest"

[tasks.release]
description = "Create and push a release tag. Usage: mise run release 1.0.0"
run = """
#!/usr/bin/env bash
set -e
VERSION="$1"
if [ -z "$VERSION" ]; then
  echo "Usage: mise run release <version>"
  echo "Example: mise run release 1.0.0"
  exit 1
fi
echo "Creating release v$VERSION..."
git tag -a "v$VERSION" -m "Release v$VERSION"
git push origin "v$VERSION"
echo "Done! Watch the release at: https://github.com/king8fisher/panex/actions"
"""

[tasks.build]
dir = "panex-rs"
run = "cargo build --release"

[tasks.dev]
depends = ["build"]
dir = "panex-rs"
run = """
cargo run -- \
  "while true; do echo 'ping'; sleep 1; done" \
  "while true; do date; sleep 1; done" \
  "for i in {1..20}; do echo line $i; sleep 0.5; done" \
  "while true; do echo -e '\\033[31mRed\\033[0m \\033[32mGreen\\033[0m \\033[34mBlue\\033[0m \\033[33mYellow\\033[0m'; sleep 1; done" \
  "while true; do echo -e '\\033[1mBold\\033[0m \\033[4mUnderline\\033[0m \\033[1;32mBold Green\\033[0m'; sleep 1; done" \
  -n ping,date,lines,colors,bold
"""
